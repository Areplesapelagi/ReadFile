<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendees List</title>
</head>
<body>
    <h1>Attendees List</h1>
    <form id="attendee-form">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br><br>
        <label for="pax">Pax:</label>
        <input type="number" id="pax" name="pax" required><br><br>
        <label for="status">Status:</label>
        <select id="status" name="status" required>
            <option value="Going">Going</option>
            <option value="Not Going">Not Going</option>
        </select><br><br>
        <label for="comment">Comment:</label>
        <textarea id="comment" name="comment" rows="4" cols="50"></textarea><br><br>
        <button type="submit">Submit</button>
    </form>

    <h2>Going</h2>
    <div id="going-attendees"></div>
    <h2>Not Going</h2>
    <div id="not-going-attendees"></div>

    <h2>Statistics</h2>
    <p><strong>Total Going:</strong> <span id="total-going">0</span></p>
    <p><strong>Total Not Going:</strong> <span id="total-not-going">0</span></p>
    <p><strong>Total Pax:</strong> <span id="total-pax">0</span></p>

    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script>
        // Your Firebase configuration
        const firebaseConfig = {
  apiKey: "AIzaSyAUcAdcSR2jIiDWI3J_Wa78Xiy-saqMU78",
  authDomain: "rsvp-daacd.firebaseapp.com",
  projectId: "rsvp-daacd",
  storageBucket: "rsvp-daacd.appspot.com",
  messagingSenderId: "257111835647",
  appId: "1:257111835647:web:51b0d155e48363713eddca",
  measurementId: "G-5ZWXHTGDPG"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Handle form submission
        document.getElementById('attendee-form').addEventListener('submit', async function(event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const pax = document.getElementById('pax').value;
            const status = document.getElementById('status').value;
            const comment = document.getElementById('comment').value;

            try {
                await db.collection('attendees').add({
                    name,
                    pax: parseInt(pax, 10),
                    status,
                    comment
                });
                alert('Attendee details submitted successfully!');
                event.target.reset();
                loadAttendees();
            } catch (error) {
                console.error('Error adding document: ', error);
            }
        });

        // Load attendees from Firestore
        async function loadAttendees() {
            const goingContainer = document.getElementById('going-attendees');
            const notGoingContainer = document.getElementById('not-going-attendees');
            const totalGoingElem = document.getElementById('total-going');
            const totalNotGoingElem = document.getElementById('total-not-going');
            const totalPaxElem = document.getElementById('total-pax');

            goingContainer.innerHTML = '';
            notGoingContainer.innerHTML = '';

            let totalGoing = 0;
            let totalNotGoing = 0;
            let totalPax = 0;

            try {
                const snapshot = await db.collection('attendees').get();
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const attendeeHTML = `
                        <div>
                            <h3>${data.name}</h3>
                            <p><strong>Pax:</strong> ${data.pax || 'N/A'}</p>
                            <p><strong>Comment:</strong> ${data.comment || 'N/A'}</p>
                        </div>
                    `;

                    if (data.status === 'Going') {
                        goingContainer.innerHTML += attendeeHTML;
                        totalGoing++;
                    } else if (data.status === 'Not Going') {
                        notGoingContainer.innerHTML += attendeeHTML;
                        totalNotGoing++;
                    }

                    totalPax += data.pax || 0;
                });

                totalGoingElem.textContent = totalGoing;
                totalNotGoingElem.textContent = totalNotGoing;
                totalPaxElem.textContent = totalPax;
            } catch (error) {
                console.error('Error fetching documents: ', error);
            }
        }

        // Initial load
        loadAttendees();
    </script>
</body>
</html>
